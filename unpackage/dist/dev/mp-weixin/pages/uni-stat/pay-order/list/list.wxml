<view class="data-v-37c14378"><view class="uni-header data-v-37c14378"><view class="uni-group data-v-37c14378"><uni-stat-breadcrumb vue-id="c066297c-1" class="data-v-37c14378" bind:__l="__l"></uni-stat-breadcrumb></view><view class="uni-group data-v-37c14378"><button class="uni-button data-v-37c14378" type="default" size="mini" data-event-opts="{{[['tap',[['search',['$event']]]]]}}" bindtap="__e">搜索</button><download-excel class="hide-on-phone data-v-37c14378" vue-id="c066297c-2" fields="{{exportExcel.fields}}" data="{{exportExcelData}}" type="{{exportExcel.type}}" name="{{exportExcel.filename}}" bind:__l="__l" vue-slots="{{['default']}}"><button class="uni-button data-v-37c14378" type="primary" size="mini">导出 Excel</button></download-excel></view></view><view class="uni-container data-v-37c14378"><view class="uni-stat--x data-v-37c14378"><uni-stat-tabs vue-id="c066297c-3" label="平台选择" type="boldLine" mode="platform" value="{{query.platform}}" data-event-opts="{{[['^change',[['platformChange']]],['^input',[['__set_model',['$0','platform','$event',[]],['query']]]]]}}" bind:change="__e" bind:input="__e" class="data-v-37c14378" bind:__l="__l"></uni-stat-tabs></view><unicloud-db scoped-slots-compiler="augmented" vue-id="c066297c-4" collection="{{collectionList}}" field="user_id,nickname,provider,provider_pay_type,uni_platform,status,type,order_no,out_trade_no,transaction_id,device_id,client_ip,openid,description,err_msg,total_fee,refund_fee,refund_count,refund_list,provider_appid,appid,user_order_success,create_date,pay_date,notify_date,cancel_date" where="{{where}}" page-data="replace" orderby="{{orderby}}" getcount="{{true}}" page-size="{{options.pageSize}}" page-current="{{options.pageCurrent}}" options="{{options}}" loadtime="manual" data-ref="udb" data-event-opts="{{[['^load',[['onqueryload']]]]}}" bind:load="__e" class="data-v-37c14378 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><block wx:if="{{$root.m0}}"><uni-table style="min-height:900px;" vue-id="{{('c066297c-5')+','+('c066297c-4')}}" loading="{{$root.m1}}" emptyText="{{$root.m2?'请求中...':'没有更多数据'}}" border="{{true}}" stripe="{{true}}" type data-ref="table" data-event-opts="{{[['^selectionChange',[['selectionChange']]]]}}" bind:selectionChange="__e" class="data-v-37c14378 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><uni-tr vue-id="{{('c066297c-6')+','+('c066297c-5')}}" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><uni-th vue-id="{{('c066297c-7')+','+('c066297c-6')}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">序号</uni-th><uni-th vue-id="{{('c066297c-8')+','+('c066297c-6')}}" align="center" filterDefaultValue="{{filterDefaultValueUserId}}" filter-type="search" sortable="{{true}}" data-ref="user_id" data-event-opts="{{[['^filterChange',[['filterChange',['$event','user_id']]]],['^sortChange',[['sortChange',['$event','user_id']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378 vue-ref" bind:__l="__l" vue-slots="{{['default']}}">用户</uni-th><uni-th vue-id="{{('c066297c-9')+','+('c066297c-6')}}" align="center" filter-type="select" filter-data="{{$root.m3.filterData.provider_localdata}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','provider']]]]]}}" bind:filterChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">支付供应商</uni-th><uni-th vue-id="{{('c066297c-10')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','provider_pay_type']]]],['^sortChange',[['sortChange',['$event','provider_pay_type']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">支付方式</uni-th><uni-th vue-id="{{('c066297c-11')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','uni_platform']]]],['^sortChange',[['sortChange',['$event','uni_platform']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">应用平台</uni-th><uni-th vue-id="{{('c066297c-12')+','+('c066297c-6')}}" align="center" filter-type="select" filter-data="{{$root.m4.filterData.status_localdata}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','status']]]]]}}" bind:filterChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">订单状态</uni-th><uni-th vue-id="{{('c066297c-13')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','type']]]],['^sortChange',[['sortChange',['$event','type']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">订单类型</uni-th><uni-th vue-id="{{('c066297c-14')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','order_no']]]],['^sortChange',[['sortChange',['$event','order_no']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">业务系统订单号</uni-th><uni-th vue-id="{{('c066297c-15')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','out_trade_no']]]],['^sortChange',[['sortChange',['$event','out_trade_no']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">支付插件订单号</uni-th><uni-th vue-id="{{('c066297c-16')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','transaction_id']]]],['^sortChange',[['sortChange',['$event','transaction_id']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">交易单号</uni-th><uni-th vue-id="{{('c066297c-17')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','description']]]],['^sortChange',[['sortChange',['$event','description']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">支付描述</uni-th><uni-th vue-id="{{('c066297c-18')+','+('c066297c-6')}}" align="center" filter-type="range" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','total_fee',0.01]]]],['^sortChange',[['sortChange',['$event','total_fee']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">订单支付金额</uni-th><uni-th vue-id="{{('c066297c-19')+','+('c066297c-6')}}" align="center" filter-type="range" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','refund_fee',0.01]]]],['^sortChange',[['sortChange',['$event','refund_fee']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">订单退款金额</uni-th><uni-th vue-id="{{('c066297c-20')+','+('c066297c-6')}}" align="center" filter-type="range" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','refund_count']]]],['^sortChange',[['sortChange',['$event','refund_count']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">当前退款笔数</uni-th><uni-th vue-id="{{('c066297c-21')+','+('c066297c-6')}}" align="center" sortable="{{true}}" data-event-opts="{{[['^sortChange',[['sortChange',['$event','user_order_success']]]]]}}" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">回调状态</uni-th><uni-th vue-id="{{('c066297c-22')+','+('c066297c-6')}}" align="center" filter-type="timestamp" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','create_date']]]],['^sortChange',[['sortChange',['$event','create_date']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">创建时间</uni-th><uni-th vue-id="{{('c066297c-23')+','+('c066297c-6')}}" align="center" filter-type="timestamp" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','pay_date']]]],['^sortChange',[['sortChange',['$event','pay_date']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">支付时间</uni-th><uni-th vue-id="{{('c066297c-24')+','+('c066297c-6')}}" align="center" filter-type="timestamp" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','cancel_date']]]],['^sortChange',[['sortChange',['$event','cancel_date']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">取消时间</uni-th><uni-th vue-id="{{('c066297c-25')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','provider_appid']]]],['^sortChange',[['sortChange',['$event','provider_appid']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">开放平台appid</uni-th><uni-th vue-id="{{('c066297c-26')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','appid']]]],['^sortChange',[['sortChange',['$event','appid']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">DCloud AppId</uni-th><uni-th vue-id="{{('c066297c-27')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','device_id']]]],['^sortChange',[['sortChange',['$event','device_id']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">设备ID</uni-th><uni-th vue-id="{{('c066297c-28')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','client_ip']]]],['^sortChange',[['sortChange',['$event','client_ip']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">客户端IP</uni-th><uni-th vue-id="{{('c066297c-29')+','+('c066297c-6')}}" align="center" filter-type="search" sortable="{{true}}" data-event-opts="{{[['^filterChange',[['filterChange',['$event','openid']]]],['^sortChange',[['sortChange',['$event','openid']]]]]}}" bind:filterChange="__e" bind:sortChange="__e" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">openid</uni-th></uni-tr><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><uni-tr vue-id="{{('c066297c-30-'+index)+','+('c066297c-5')}}" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><uni-td vue-id="{{('c066297c-31-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.m5+''}}</uni-td><uni-td vue-id="{{('c066297c-32-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><text data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" data-event-params="{{({item:item.$orig})}}" class="text-btn data-v-37c14378" bindtap="__e">{{item.m6}}</text></uni-td><uni-td vue-id="{{('c066297c-33-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{options.provider_valuetotext[item.$orig.provider]}}</uni-td><uni-td vue-id="{{('c066297c-34-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.provider_pay_type}}</uni-td><uni-td vue-id="{{('c066297c-35-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.uni_platform}}</uni-td><uni-td vue-id="{{('c066297c-36-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{options.status_valuetotext[item.$orig.status]}}</uni-td><uni-td vue-id="{{('c066297c-37-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.type}}</uni-td><uni-td vue-id="{{('c066297c-38-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.order_no}}</uni-td><uni-td vue-id="{{('c066297c-39-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.out_trade_no}}</uni-td><uni-td vue-id="{{('c066297c-40-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.transaction_id}}</uni-td><uni-td vue-id="{{('c066297c-41-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.description}}</uni-td><uni-td vue-id="{{('c066297c-42-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.g0}}</uni-td><uni-td vue-id="{{('c066297c-43-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.g1}}</uni-td><uni-td vue-id="{{('c066297c-44-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.refund_count}}</uni-td><uni-td vue-id="{{('c066297c-45-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><block wx:if="{{item.$orig.user_order_success===true}}"><view style="color:#18bc37;" class="data-v-37c14378">✔正常</view></block><block wx:else><block wx:if="{{item.g2>-1}}"><view class="data-v-37c14378">-</view></block><block wx:else><view style="color:#e43d33;" class="data-v-37c14378">●异常</view></block></block></uni-td><uni-td vue-id="{{('c066297c-46-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><uni-dateformat vue-id="{{('c066297c-47-'+index)+','+('c066297c-46-'+index)}}" threshold="{{[0,0]}}" date="{{item.$orig.create_date}}" class="data-v-37c14378" bind:__l="__l"></uni-dateformat></uni-td><uni-td vue-id="{{('c066297c-48-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><uni-dateformat vue-id="{{('c066297c-49-'+index)+','+('c066297c-48-'+index)}}" threshold="{{[0,0]}}" date="{{item.$orig.pay_date}}" class="data-v-37c14378" bind:__l="__l"></uni-dateformat></uni-td><uni-td vue-id="{{('c066297c-50-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><uni-dateformat vue-id="{{('c066297c-51-'+index)+','+('c066297c-50-'+index)}}" threshold="{{[0,0]}}" date="{{item.$orig.cancel_date}}" class="data-v-37c14378" bind:__l="__l"></uni-dateformat></uni-td><uni-td vue-id="{{('c066297c-52-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.provider_appid}}</uni-td><uni-td vue-id="{{('c066297c-53-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.appid}}</uni-td><uni-td vue-id="{{('c066297c-54-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.device_id}}</uni-td><uni-td vue-id="{{('c066297c-55-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.client_ip}}</uni-td><uni-td vue-id="{{('c066297c-56-'+index)+','+('c066297c-30-'+index)}}" align="center" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.openid}}</uni-td></uni-tr></block></uni-table><view class="uni-pagination-box data-v-37c14378"><uni-pagination vue-id="{{('c066297c-57')+','+('c066297c-4')}}" show-icon="{{true}}" page-size="{{$root.m7.size}}" total="{{$root.m8.count}}" value="{{$root.m9.current}}" data-event-opts="{{[['^change',[['onPageChanged']]],['^input',[['__set_model',['$0','current','$event',[]],['pagination']]]]]}}" bind:change="__e" bind:input="__e" class="data-v-37c14378" bind:__l="__l"></uni-pagination></view></block></unicloud-db></view><uni-popup vue-id="c066297c-58" type="center" animation="{{false}}" data-ref="popup" class="data-v-37c14378 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><view style="padding:30px;background-color:#ffffff;width:500px;" class="data-v-37c14378"><view style="margin-bottom:20px;text-align:center;font-size:20px;font-weight:bold;" class="data-v-37c14378">退款确认</view><uni-forms vue-id="{{('c066297c-59')+','+('c066297c-58')}}" modelValue="{{refundFormData}}" label-position="left" labelWidth="100px" rules="{{refundFormRules}}" data-ref="refundForm" class="data-v-37c14378 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><uni-forms-item vue-id="{{('c066297c-60')+','+('c066297c-59')}}" label="退款金额" name="refund_fee" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><uni-easyinput bind:input="__e" vue-id="{{('c066297c-61')+','+('c066297c-60')}}" type="text" placeholder="请输入退款金额" clearable="{{false}}" value="{{refundFormData.refund_fee}}" data-event-opts="{{[['^input',[['__set_model',['$0','refund_fee','$event',[]],['refundFormData']]]]]}}" class="data-v-37c14378" bind:__l="__l"></uni-easyinput><view style="color:#666;margin-top:5px;font-size:12px;" class="data-v-37c14378">{{"最大可退："+refundFormData.max_refund_fee}}</view></uni-forms-item><uni-forms-item vue-id="{{('c066297c-62')+','+('c066297c-59')}}" label="退款原因" name="refund_desc" class="data-v-37c14378" bind:__l="__l" vue-slots="{{['default']}}"><uni-easyinput bind:input="__e" vue-id="{{('c066297c-63')+','+('c066297c-62')}}" type="textarea" placeholder="请输入退款原因" clearable="{{false}}" value="{{refundFormData.refund_desc}}" data-event-opts="{{[['^input',[['__set_model',['$0','refund_desc','$event',[]],['refundFormData']]]]]}}" class="data-v-37c14378" bind:__l="__l"></uni-easyinput></uni-forms-item><button style="width:100px;height:40px;font-size:16px;" type="warn" data-event-opts="{{[['tap',[['confirmRefund',['$0'],['refundFormData']]]]]}}" bindtap="__e" class="data-v-37c14378">确定</button></uni-forms></view></uni-popup></view>